YUI.add("hermes-template-head-meta",(function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,l){return'name="'},3:function(e,n,a,t,l){return'property="'},5:function(e,n,a,t,l){return'description="'+e.escapeExpression(e.lambda(n,n))+'"'},compiler:[8,">= 4.3.0"],main:function(e,n,a,t,l){var r,o,i,m=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,p=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]},d="<meta "+(null!=(r=p(a,"if").call(m,null!=n?p(n,"isName"):n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.program(3,l,0),data:l,loc:{start:{line:1,column:6},end:{line:1,column:51}}}))?r:"")+u(typeof(o=null!=(o=p(a,"metaName")||(null!=n?p(n,"metaName"):n))?o:s)===c?o.call(m,{name:"metaName",hash:{},data:l,loc:{start:{line:1,column:51},end:{line:1,column:63}}}):o)+'" content="'+u((p(a,"renderMetaInfo")||n&&p(n,"renderMetaInfo")||s).call(m,null!=n?p(n,"metaValue"):n,{name:"renderMetaInfo",hash:{},data:l,loc:{start:{line:1,column:74},end:{line:1,column:102}}}))+'" ';return o=null!=(o=p(a,"metaDescription")||(null!=n?p(n,"metaDescription"):n))?o:s,i={name:"metaDescription",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:104},end:{line:1,column:163}}},r=typeof o===c?o.call(m,i):o,p(a,"metaDescription")||(r=e.hooks.blockHelperMissing.call(n,r,i)),null!=r&&(d+=r),d+' data-dynamic="true">\n'},useData:!0}),t={};e.Array.each([],(function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)})),e.Template.register("hermes/head-meta",(function(n,l){return(l=l||{}).partials=l.partials?e.merge(t,l.partials):t,a(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-ad-card",(function(a,e){var n=a.Template.Handlebars.revive({1:function(a,e,n,l,t){return" theme-flat"},compiler:[8,">= 4.3.0"],main:function(a,e,n,l,t){var r,o=a.lookupProperty||function(a,e){if(Object.prototype.hasOwnProperty.call(a,e))return a[e]};return'<div class="ad-card\n\t'+(null!=(r=(o(n,"ifCond")||e&&o(e,"ifCond")||a.hooks.helperMissing).call(null!=e?e:a.nullContext||{},null!=e?o(e,"theme"):e,"===","flat",{name:"ifCond",hash:{},fn:a.program(1,t,0),inverse:a.noop,data:t,loc:{start:{line:2,column:1},end:{line:2,column:53}}}))?r:"")+'">\n\t<div class="ad-content-container">\n'+(null!=(r=a.invokePartial(o(l,"prbd-moola-position"),e,{name:"prbd-moola-position",hash:{upgradeProLink:null!=(r=null!=e?o(e,"adConfig"):e)?o(r,"upgradeProLink"):r,upsellFallback:null!=e?o(e,"upsellFallback"):e,adUnit:null!=(r=null!=e?o(e,"adConfig"):e)?o(r,"adUnit"):r},data:t,indent:"\t\t",helpers:n,partials:l,decorators:a.decorators}))?r:"")+"\t</div>\n</div>\n"},usePartial:!0,useData:!0}),l={};a.Array.each(["prbd-moola-position"],(function(e){var n=a.Template.get("hermes/"+e);n&&(l[e]=n)})),a.Template.register("hermes/ad-card",(function(e,t){return(t=t||{}).partials=t.partials?a.merge(l,t.partials):l,n(e,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-prbd-moola-position"]});YUI.add("flickr-photos-recommendations-feedback-add-updater",(function(e,r){"use strict";e.namespace("ModelUpdaters")["flickr-photos-recommendations-feedback-add"]={run:function(o,d){var c={};return c.photo_id=o.photoId,c.rec_id=o.recId,d.callAPI("flickr.photos.recommendations.feedback.add",c).then(null,e.FetcherErrorLogger(r))}}}),"@VERSION@",{requires:["flickr-promise"]});YUI.add("activity-model",(function(e,t){function r(e){r.superclass.constructor.call(this,e)}e.Models[this.name]=r,e.extend(r,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-feed-getBatchPhotos"]}},photoPrivacies:{isCollection:!0},time:{},count:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},photosCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},videosCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},recommended:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},curated:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},eventType:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},ownerId:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},groupId:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},groupName:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},recId:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isDisabled:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},iconUrls:{},data:{},isStaticContent:{readOnly:!0,derivedBy:["eventType"],defaultFn:function(e){return"StaticContent_General"===this.getValue(e,"eventType")||"StaticContent_Help"===this.getValue(e,"eventType")}},isStaticHelp:{readOnly:!0,derivedBy:["eventType"],defaultFn:function(e){return"StaticContent_Help"===this.getValue(e,"eventType")}},staticAttribution:{readOnly:!0,derivedBy:["eventType"],defaultFn:function(e){var t=this.getValue(e,"eventType"),r="";return t&&(r="StaticContent_General"===t?this.intlMessage({intlName:"feed.FLICKR_EDITORIAL"}):"StaticContent_Help"===t?this.intlMessage({intlName:"feed.FLICKR_HELP"}):"Flickr"),r}},people:[]}},{})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-feed-getFeed-fetcher","photo-model-helper"],langBundles:["models","feed"]});YUI.add("flickr-feed-getFeed-fetcher",(function(e,t){"use strict";function o(e,t){var o={event_types:e.eventTypes,rec_pos:12,extras:"all_sizes,icon_urls_deep,needs_interstitial,safety_level",get_user_info:1,per_batch:e.perBatch||5};e.relationshipFilter&&(o.relationship_filter=e.relationshipFilter);var r="General,Help";return t.flipper.isFlipped("enable-feed-sponsored-cards")&&(r+=",Sponsored"),o.static_content_types=r,e.invalidate&&(o.invalidate=(new Date).getTime()),e.compact&&(o.compact=1),"start"in e||"end"in e?(o.batchid=e.batchId||0,"start"in e&&(o.start=e.start),"end"in e&&(o.end=e.end)):(o.per_page=e.perPage||30,o.page=e.page||1),o}e.namespace("ListFetchers")["flickr-feed-getFeed"]={run:function(r,a){var i=this,s=o(r,a);return e.Promise.all([a.callAPI("flickr.feed.getFeed",s,!0),a.getModelRegistry("activity-models"),a.getModelRegistry("activity-model"),a.getModelRegistry("photo-models"),a.getModelRegistry("person-models"),a.getModelRegistry("photo-engagement-models"),a.getModelRegistry("photo-stats-models"),a.getModelRegistry("photo-privacy-models")]).then((function(e){return i._processResponse(e,s,r,a)}),e.FetcherErrorLogger(t))},_processParams:o,_processResponse:function(t,o,r,a){var i=t[0].photos,s=t[1],n=t[2],p=t[3],d=t[4],c=t[5],l=t[6],h=t[7],g={id:r.id,totalItems:i.total},m=[];return Object.entries(i.photo).forEach((([t,o])=>{var r;Array.isArray(o)?(r=o.shift(),o.forEach((e=>{r.count+=e.count,r.countVideo+=e.countVideo,r.countPhoto+=e.countPhoto,r.photos=r.photos.concat(e.photos),r.batchid+=","+e.batchid}))):r=o;var a,i={},s=[];if(r.count>0){i.isDisabled=!1,i.time=r.time,i.iconUrls=r.iconurls,i.id=r.batchid,i.recommended=r.recommended,i.curated=r.curated,i.eventType=r.eventType||"UploadBatch",i.count=r.count,i.videosCount=parseInt(r.countVideo,10)||0,i.photosCount=parseInt(r.countPhoto,10)||0,"GroupBatch"===r.eventType?(i.groupId=r.owner,i.groupName=r.ownername):r.eventType.indexOf("StaticContent")>-1?(i.groupId=!1,i.data=r.data):"Flickrec"===r.eventType?i.recId=r.photos[0].recommendation_id:i.ownerId=r.owner,a=e.APIHelper.response.parsePhotos({photos:r.photos,personModelRegistry:d,photoModelRegistry:p,photoEngagementModelRegistry:c,photoStatsModelRegistry:l}),i.photos=a;var g=[];r.photos.forEach((function(e){var t={id:e.id,isPublic:e.ispublic,isVisibleByFriends:e.isfriend,isVisibleByFamily:e.isfamily};g.push(h.addOrUpdate(t))})),i.photoPrivacies=g,r.people&&r.people.forEach((function(t){var o=t.person,r={id:o.id,pathAlias:o.pathAlias,username:o.username&&o.username._content,realname:o.realname&&o.realname._content,buddyicon:e.APIHelper.response.removeProtocolFromURL(o.iconurls),isAdFree:o.isAdFree,isPro:o.ispro,proBadge:o.proBadge,isMinor:o.isMinor,hasStats:o.hasStats,location:o.location&&o.location._content,hasAdfree:o.hasAdfree,has1TB:o.has1TB,has2TB:o.has2TB,hasUnlimitedStorage:o.hasUnlimitedStorage,hasFreeStandardShipping:o.hasFreeStandardShipping,hasFreeEducationalResources:o.hasFreeEducationalResources,expiringPartner:o.expiringPartner},a=d.addOrUpdate(r);s.push({id:o.id,coverPhotoUrls:e.APIHelper.response.removeProtocolFromURL(o.coverphoto_url),model:a})})),i.people=s,m.push(n.addOrUpdate(i))}})),g.activityList={perPage:i.perPage,page:i.page||1,pageContent:m,totalItems:i.total,totalPages:i.pages},s.addOrUpdate(g),{beforeCount:i.remaining_before,afterCount:i.remaining_after,activityModels:g.activityList.pageContent}}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["activity-models","activity-model","photo-models","person-models","photo-engagement-models","photo-stats-models","photo-privacy-models"]});YUI.add("activity-models",(function(e,t){function n(e){n.superclass.constructor.call(this,e)}e.Models[this.name]=n,e.extend(n,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-feed-getFeed"].run(t,this.appContext)},updateRecommendedFeedback:function(t,n){return e.ModelUpdaters["flickr-photos-recommendations-feedback-add"].run(t,n)}},updateRecommendedFeedbackRemote:function(e,t,n){return this.remote.updateRecommendedFeedback.call(this,{recId:n,photoId:t},this.appContext)},readLastUpdateRemote:function(){return this.appContext.callAPI("flickr.activity.lastUpdate",{}).then((function(e){return e&&e.activity&&e.activity.lastUpdate?e.activity.lastUpdate:null}))},insertUserPrefsRemote:function(e,t){return this.appContext.callAPI("flickr.feed.preferences.insertUserPreferences",t).then((function(e){return e}),(function(e){return e}))},muteObject:function(e,t){return this.appContext.callAPI("flickr.feed.preferences.muteObject",t).then((function(e){return e}),(function(e){return e}))},unMuteObject:function(e,t){return this.appContext.callAPI("flickr.feed.preferences.unmuteObject",t).then((function(e){return e}),(function(e){return e}))},muteEventType:function(e,t){return this.appContext.callAPI("flickr.feed.preferences.muteEventType",t).then((function(e){return e}),(function(e){return e}))},attributes:{activityList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-feed-getFeed"]}},totalItems:{defaultFn:function(){return null}}}},{})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-feed-getFeed-fetcher","flickr-photos-recommendations-feedback-add-updater","photo-model-helper"],langBundles:["models"]});YUI.add("hermes-template-feed-error-message",(function(e,n){var r=e.Template.Handlebars.revive({1:function(e,n,r,l,t){var a,o=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t\t<h2 class="error-title">'+e.escapeExpression("function"==typeof(a=null!=(a=o(r,"title")||(null!=n?o(n,"title"):n))?a:e.hooks.helperMissing)?a.call(null!=n?n:e.nullContext||{},{name:"title",hash:{},data:t,loc:{start:{line:3,column:26},end:{line:3,column:35}}}):a)+"</h2>\n"},3:function(e,n,r,l,t){var a=null!=n?n:e.nullContext||{},o=e.hooks.helperMissing,s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t\t<p class="error-message">'+e.escapeExpression((s(r,"preventOrphansHtml")||n&&s(n,"preventOrphansHtml")||o).call(a,(s(r,"renderTrustedMarkup")||n&&s(n,"renderTrustedMarkup")||o).call(a,null!=n?s(n,"message"):n,{name:"renderTrustedMarkup",hash:{},data:t,loc:{start:{line:6,column:48},end:{line:6,column:77}}}),{name:"preventOrphansHtml",hash:{},data:t,loc:{start:{line:6,column:27},end:{line:6,column:79}}}))+"</p>\n"},compiler:[8,">= 4.3.0"],main:function(e,n,r,l,t){var a,o=null!=n?n:e.nullContext||{},s=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'<div class="feed-error-message">\n'+(null!=(a=s(r,"if").call(o,null!=n?s(n,"title"):n,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:2,column:1},end:{line:4,column:8}}}))?a:"")+(null!=(a=s(r,"if").call(o,null!=n?s(n,"message"):n,{name:"if",hash:{},fn:e.program(3,t,0),inverse:e.noop,data:t,loc:{start:{line:5,column:1},end:{line:7,column:8}}}))?a:"")+"</div>"},useData:!0}),l={};e.Array.each([],(function(n){var r=e.Template.get("hermes/"+n);r&&(l[n]=r)})),e.Template.register("hermes/feed-error-message",(function(n,t){return(t=t||{}).partials=t.partials?e.merge(l,t.partials):l,r(n,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("feed-helper",(function(e,t){var a=e.mix({langBundles:["common","feed","feed-new"]},e.Localizable);e.FeedHelper=function(t){var n=new e.PhotoCardHelper(t),r=new e.TemplateLibraryHelper(t),o={photoCardHelper:n,layoutValues:{large:{CARD_SPACING:32,CARD_SPACING_MOBILE:16},medium:{CARD_SPACING:32,TARGET_ROW_HEIGHT:280,TARGET_ROW_HEIGHT_MOBILE:300,TARGET_ROW_HEIGHT_TOLERANCE:.5,GENERATED_LAYOUT_WIDTH:1e3,GENERATED_LAYOUT_SPACING:4,GENERATED_LAYOUT_ROW_HEIGHT_RATIO:.35,GENERATED_LAYOUT_TARGET_ROW_HEIGHT_TOLERANCE:.3,MAX_BATCH_AR:2.5,MIN_BATCH_AR:1},compact:{CARD_SPACING:40,GENERATED_LAYOUT_WIDTH:1e3,GENERATED_LAYOUT_SPACING:4},batchLarge:{CARD_SPACING:16,TARGET_ROW_HEIGHT:320,TARGET_ROW_HEIGHT_MOBILE:300,TARGET_ROW_HEIGHT_TOLERANCE:.3},batchMedium:{CARD_SPACING:32,TARGET_ROW_HEIGHT:320,TARGET_ROW_HEIGHT_MOBILE:300,TARGET_ROW_HEIGHT_TOLERANCE:.3},batchCompact:{CARD_SPACING:32,TARGET_ROW_HEIGHT:320,TARGET_ROW_HEIGHT_MOBILE:300,TARGET_ROW_HEIGHT_TOLERANCE:.3}},EVENT_TYPE_INTL:{Flickrec:{intlName:"feed.RECOMMENDED"},StaticRec:{intlName:"feed.RECOMMENDED"},SelfBatch:null,UploadBatch:null,GroupBatch:{intlName:"feed.GROUPS_ACTIVITY_LABEL"},ad:{intlName:"feed.SPONSORED"},StaticContent_Sponsored:{intlName:"feed.SPONSORED"},StaticContent_General:null,StaticContent_Help:null},PER_BATCH:15,AD_CADENCE:7,getCappedPhotoHeight:function(e){e.height;return Math.min(e.height,Math.max(t.viewportData.getHeight()*e.viewportProportion-e.additionalCardHeight,e.minHeight))},getEventTypeName:function(e){var t=this.EVENT_TYPE_INTL[e];return t?a.intlMessage(t):""},getItemAttribution:function(e){var t={};switch(e.eventType){case"Flickrec":case"StaticRec":case"SelfBatch":case"ad":case"StaticContent_Sponsored":break;case"UploadBatch":t={id:e.photoItems[0].owner.nsid,title:e.photoItems[0].owner.displayname,url:"/photos/"+e.photoItems[0].owner.pathAlias,iconUrl:e.photoItems[0].owner.buddyicon.default,isPro:e.photoItems[0].owner.isPro,proBadgeType:e.photoItems[0].owner.proBadgeType};break;case"GroupBatch":t={id:e.groupId,title:e.groupName,url:"/groups/"+e.groupId,iconUrl:e.iconUrls.default};break;case"StaticContent_General":t={title:a.intlMessage({intlName:"feed.FLICKR_EDITORIAL"}),url:e.staticContent.link};break;case"StaticContent_Help":t={title:a.intlMessage({intlName:"feed.FLICKR_HELP"}),url:e.staticContent.link}}return t.activityName=this.getEventTypeName(e.eventType),t.time=e.time,t},getLinkFooterConfig:function(e){var t={};switch(e.eventType){case"Flickrec":case"StaticRec":case"SelfBatch":case"ad":case"StaticContent_Sponsored":case"StaticContent_General":case"StaticContent_Help":break;case"UploadBatch":t={text:a.intlMessage({intlName:"feed.VIEW_IN_PHOTOSTREAM"}),url:"/photos/"+e.photoItems[0].owner.pathAlias};break;case"GroupBatch":t={text:a.intlMessage({intlName:"feed.VIEW_GROUP_POOL"}),url:"/groups/"+e.groupId+"/pool"}}return t},getEventTypes:function(e){var t="UploadBatch,GroupBatch,ContactRec";return e&&("groups"===e?t="GroupBatch":"people"===e?t="UploadBatch,ContactRec":"friends_and_family"===e&&(t="UploadBatch")),t},convertActivityModel:function(t){var a=this,n=t.getValue("photos").getList(),r=t.getValue("people"),o={id:e.guid(),layoutRenderType:"feedCard",batchId:t.getValue("id"),eventType:t.getValue("eventType"),owner:{nsid:t.getValue("ownerId")},isRecommended:t.getValue("recommended"),isStaticContent:t.getValue("isStaticContent"),isStaticHelp:t.getValue("isStaticHelp"),time:t.getValue("time"),count:t.getValue("count"),model:t};return"GroupBatch"===o.eventType&&(o.groupId=t.getValue("groupId"),o.groupName=t.getValue("groupName"),o.iconUrls=t.getValue("iconUrls")),o.eventType.indexOf("StaticContent")>-1&&(o.staticContent=t.getValue("data")),o.photoItems=n.map((function(e){return a.photoCardHelper.convertPhotoModel(e)})),r&&(o.personItems=r.map((function(e){return a.convertPerson(e)}))),o},convertPerson:function(t){var a=t.model,n=a.getValue("isPro");return{id:e.guid(),nsid:a.getValue("nsid"),url:a.getValue("url"),displayname:a.getValue("displayname"),username:a.getValue("username"),buddyicon:a.getValue("buddyicon"),pathAlias:a.getValue("pathAlias"),isPro:n,proBadgeType:n?a.getValue("proBadge"):void 0,coverPhotoUrls:t.coverPhotoUrls,model:a}},generateListsFromItems:function(e){var t=0,a=[];return e.forEach((function(n,r){"ContactRec"===n.eventType||"ad"===n.eventType?(r>t&&a.push({layoutRenderType:"activityCard",items:e.slice(t,r)}),a.push({layoutRenderType:"ad"===n.eventType?"ad":"people",items:[e[r]]}),t=r+1):r===e.length-1&&a.push({layoutRenderType:"activityCard",items:e.slice(t,r+1)})})),a},promiseSync:function(t,a){var n=this,r=t.shift();return a=a||[],r?r().then((function(e){return a.push(e),n.promiseSync(t,a)})):e.Promise.resolve(a)},getEmptyStateMessage:function(t,n){var o;switch(t){case"all":o=r.getTemplate("feed-error-message")({title:a.intlMessage({intlName:"feed.NO_ACTIVITY_RIGHT_NOW"}),message:a.intlMessage({intlName:"feed.CHECK_OUT_RECS_BELOW"})});break;case"groups":o=r.getTemplate("feed-error-message")({title:a.intlMessage({intlName:"feed.EMPTY_GROUPS_1"}),message:a.intlMessage({intlName:"feed.EMPTY_GROUPS_2",groupsUrl:"/groups"})});break;case"people":o=r.getTemplate("feed-error-message")({title:a.intlMessage({intlName:"feed.EMPTY_PEOPLE_1"}),message:a.intlMessage({intlName:"feed.CHECK_OUT_RECS_BELOW"})});break;case"friends_and_family":o=r.getTemplate("feed-error-message")({title:a.intlMessage({intlName:"feed.EMPTY_FRIENDS_AND_FAMILY_1"}),message:a.intlMessage({intlName:"feed.EMPTY_FRIENDS_AND_FAMILY_2",peopleUrl:e.URLHelper.generatePersonUrls(n).list})});break;default:o=r.getTemplate("feed-error-message")({title:a.intlMessage({intlName:"feed.NO_ACTIVITY_RIGHT_NOW"}),message:a.intlMessage({intlName:"feed.NO_ACTIVITY_RIGHT_NOW"})})}return o}};return e.augment(o,e.EventTarget),o}}),"@VERSION@",{requires:["event-custom","storage-helper","photo-card-helper","url-helper","fluid-share-photo-view","fluid-share-photostream-view","hermes-template-feed-error-message"]});